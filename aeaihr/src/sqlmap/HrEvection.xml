<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="hrevection">
	<select id="findMasterRecords" parameterClass="com.agileai.domain.DataParam"
		resultClass="com.agileai.domain.DataRow">
		select
		a.EVE_ID,a.EVE_APPLY_USER,a.EVE_TOGETHER,a.EVE_START_TIME,a.EVE_OVER_TIME,
		a.EVE_REIMBURSEMENT_TIME,a.EVE_DAYS,a.EVE_SUBSIDY,a.EVE_APPROVE_USER,
		a.EVE_APPROVE_TIME,a.APP_RESULT,a.EVE_APPROVE_OPINION,a.EVE_REASON,
		b.USER_NAME as EVE_CODE_NAME,a.EVE_TOTAL_MONEY,
		c.USER_NAME as EVE_APPROVE_USER_NAME,STATE
		
		from hr_evection a left join security_user b on a.EVE_APPLY_USER=b.USER_ID 
       	left join security_user c on a.EVE_APPROVE_USER=c.USER_ID
		where 1=1
		<isNotEmpty prepend=" " property="sdate">
			and a.EVE_START_TIME &gt;=
			#sdate#
		</isNotEmpty>
		<isNotEmpty prepend=" " property="edate">
			and a.EVE_START_TIME &lt;=
			#edate#
		</isNotEmpty>
		<isNotEmpty prepend=" " property="user_Name">
			and b.USER_NAME like
			'%$user_Name$%'
		</isNotEmpty>
		<isNotEmpty prepend=" " property="approveUserCode">
			and b.USER_ID like '%$approveUserCode$%'
		</isNotEmpty>
		<isNotEmpty prepend=" " property="STATE">
			and STATE=#STATE#
		</isNotEmpty>
		order by a.EVE_START_TIME desc , b.USER_CODE
	</select>
	<select id="getMasterRecord" parameterClass="com.agileai.domain.DataParam"
		resultClass="com.agileai.domain.DataRow">
		select
		a.EVE_ID,a.EVE_APPLY_USER,a.EVE_TOGETHER,a.EVE_START_TIME,a.EVE_OVER_TIME,
		a.EVE_REIMBURSEMENT_TIME,a.EVE_DAYS,a.EVE_SUBSIDY,a.EVE_APPROVE_USER,
		a.EVE_APPROVE_TIME,a.APP_RESULT,a.EVE_APPROVE_OPINION,a.EVE_REASON,
		b.USER_NAME as EVE_CODE_NAME,a.EVE_TOTAL_MONEY,
		c.USER_NAME as EVE_APPROVE_USER_NAME,STATE
		
		from hr_evection a left join security_user b on a.EVE_APPLY_USER=b.USER_ID 
       	left join security_user c on a.EVE_APPROVE_USER=c.USER_ID
		where 1=1
		<isNotEmpty prepend="and " property="EVE_ID">
			EVE_ID=#EVE_ID#
		</isNotEmpty>
	</select>
	<insert id="insertMasterRecord" parameterClass="com.agileai.domain.DataParam">
		insert into
		hr_evection
		(EVE_ID,EVE_APPLY_USER,EVE_TOGETHER,EVE_START_TIME,EVE_OVER_TIME,EVE_REIMBURSEMENT_TIME,EVE_DAYS,EVE_SUBSIDY,EVE_APPROVE_USER,EVE_APPROVE_TIME,APP_RESULT,EVE_APPROVE_OPINION,EVE_TOTAL_MONEY,EVE_REASON,STATE)
		values
		(#EVE_ID:CHAR#,#EVE_APPLY_USER:CHAR#,#EVE_TOGETHER:VARCHAR#,#EVE_START_TIME:DATE#,#EVE_OVER_TIME:DATE#,#EVE_REIMBURSEMENT_TIME:DATETIME#,#EVE_DAYS:INTEGER#,#EVE_SUBSIDY:DECIMAL#,#EVE_APPROVE_USER:CHAR#,#EVE_APPROVE_TIME:DATE#,#APP_RESULT:VARCHAR#,#EVE_APPROVE_OPINION:VARCHAR#,'0.00',#EVE_REASON:VARCHAR#,"drafe")
	</insert>
	<update id="updateMasterRecord" parameterClass="com.agileai.domain.DataParam">
		update
		hr_evection
		set
		EVE_APPLY_USER=#EVE_APPLY_USER:CHAR#,
		EVE_TOGETHER=#EVE_TOGETHER:VARCHAR#,
		EVE_START_TIME=#EVE_START_TIME:DATETIME#,
		EVE_OVER_TIME=#EVE_OVER_TIME:DATE#,
		EVE_REIMBURSEMENT_TIME=#EVE_REIMBURSEMENT_TIME:DATETIME#,
		EVE_DAYS=#EVE_DAYS:INTEGER#,
		EVE_SUBSIDY=#EVE_SUBSIDY:DECIMAL#,
		EVE_APPROVE_USER=#EVE_APPROVE_USER:CHAR#,
		EVE_APPROVE_TIME=#EVE_APPROVE_TIME:DATE#,
		APP_RESULT=#APP_RESULT:VARCHAR#,
		EVE_APPROVE_OPINION=#EVE_APPROVE_OPINION:VARCHAR#,
		EVE_TOTAL_MONEY=#EVE_TOTAL_MONEY:DECIMAL#,
		EVE_REASON=#EVE_REASON:VARCHAR#,
		STATE=#STATE:AVRCHAR#
		where EVE_ID=#EVE_ID#
	</update>
	<update id="approveMasterRecord" parameterClass="com.agileai.domain.DataParam">
		update
		hr_evection
		set
		EVE_APPROVE_USER=#EVE_APPROVE_USER:CHAR#,
		EVE_APPROVE_TIME=#EVE_APPROVE_TIME:DATE#,
		APP_RESULT=#APP_RESULT:VARCHAR#,
		EVE_APPROVE_OPINION=#EVE_APPROVE_OPINION:VARCHAR#,
		STATE=#STATE:VARCHAR#
		where
		EVE_ID=#EVE_ID#
	</update>
	<update id="updateMasterGatherRecord" parameterClass="com.agileai.domain.DataParam">
		update
		hr_evection
		set EVE_TOTAL_MONEY=#EVE_TOTAL_MONEY:DECIMAL#
		where
		EVE_ID=#EVE_ID#
	</update>
	<delete id="deleteMasterRecord" parameterClass="com.agileai.domain.DataParam">
		delete from
		hr_evection where EVE_ID=#EVE_ID#
	</delete>
	<select id="getTotalGatherRecord" parameterClass="com.agileai.domain.DataParam"
		resultClass="com.agileai.domain.DataRow">
		select sum(EXPE_TRANSPORTATION_FEE) as
		GATHER_TRANSPORTATION_FEE,sum(EXPE_OTHER) as GATHER_EXPE_OTHER,sum(EXPE_HOTEL) as GATHER_EXPE_HOTEL
		from
		hr_expenses
		where EVE_ID=#EVE_ID#
	</select>
	<select id="findHrExpensesRecords" parameterClass="com.agileai.domain.DataParam"
		resultClass="com.agileai.domain.DataRow">
		select
		EXPE_ID,EVE_ID,EXPE_DEPART,EXPE_DESTINATION,EXPE_DEPART_TIME,EXPE_COMEBACK_TIME,EXPE_TRANSPORTATION_WAY,EXPE_TRANSPORTATION_FEE,EXPE_HOTEL,EXPE_OTHER,EXPE_REMARKS
		from hr_expenses
		where EVE_ID=#EVE_ID#
		order by EXPE_DEPART_TIME
	</select>
	<select id="getHrExpensesRecord" parameterClass="com.agileai.domain.DataParam"
		resultClass="com.agileai.domain.DataRow">
		select
		EXPE_ID,EVE_ID,EXPE_DEPART,EXPE_DESTINATION,EXPE_DEPART_TIME,EXPE_COMEBACK_TIME,EXPE_TRANSPORTATION_WAY,EXPE_TRANSPORTATION_FEE,EXPE_HOTEL,EXPE_OTHER,EXPE_REMARKS
		from hr_expenses
		where 1=1
		<isNotEmpty prepend="and " property="EXPE_ID">
			EXPE_ID=#EXPE_ID#
		</isNotEmpty>
	</select>
	<delete id="deleteHrExpensesRecords" parameterClass="com.agileai.domain.DataParam">
		delete from
		hr_expenses
		where EVE_ID=#EVE_ID#
	</delete>
	<delete id="deleteHrExpensesRecord" parameterClass="com.agileai.domain.DataParam">
		delete from
		hr_expenses where EXPE_ID=#EXPE_ID#
	</delete>
	<insert id="insertHrExpensesRecord" parameterClass="com.agileai.domain.DataParam">
		insert into
		hr_expenses
		(EXPE_ID,EVE_ID,EXPE_DEPART,EXPE_DESTINATION,EXPE_DEPART_TIME,EXPE_COMEBACK_TIME,EXPE_TRANSPORTATION_WAY,EXPE_TRANSPORTATION_FEE,EXPE_HOTEL,EXPE_OTHER,EXPE_REMARKS)
		values
		(#EXPE_ID:CHAR#,#EVE_ID:CHAR#,#EXPE_DEPART:VARCHAR#,#EXPE_DESTINATION:VARCHAR#,#EXPE_DEPART_TIME:DATETIME#,#EXPE_COMEBACK_TIME:DATETIME#,#EXPE_TRANSPORTATION_WAY:VARCHAR#,#EXPE_TRANSPORTATION_FEE:DECIMAL#,#EXPE_HOTEL:DECIMAL#,#EXPE_OTHER:DECIMAL#,#EXPE_REMARKS:VARCHAR#)
	</insert>
	<update id="updateHrExpensesRecord" parameterClass="com.agileai.domain.DataParam">
		update
		hr_expenses
		set
		EVE_ID=#EVE_ID:CHAR#,EXPE_DEPART=#EXPE_DEPART:VARCHAR#,EXPE_DESTINATION=#EXPE_DESTINATION:VARCHAR#,EXPE_DEPART_TIME=#EXPE_DEPART_TIME:DATETIME#,EXPE_COMEBACK_TIME=#EXPE_COMEBACK_TIME:DATETIME#,EXPE_TRANSPORTATION_WAY=#EXPE_TRANSPORTATION_WAY:VARCHAR#,EXPE_TRANSPORTATION_FEE=#EXPE_TRANSPORTATION_FEE:DECIMAL#,EXPE_HOTEL=#EXPE_HOTEL:DECIMAL#,EXPE_OTHER=#EXPE_OTHER:DECIMAL#,EXPE_REMARKS=#EXPE_REMARKS:VARCHAR#
		where EXPE_ID=#EXPE_ID#
	</update>
</sqlMap>